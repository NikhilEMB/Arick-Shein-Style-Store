{"version":3,"sources":["./src/app/vendor-registration/vendor-registration.page.html","./src/app/vendor-registration/vendor-registration.module.ts","./src/app/vendor-registration/vendor-registration.page.scss","./src/app/vendor-registration/vendor-registration.page.ts"],"names":[],"mappings":"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","file":"vendor-registration-vendor-registration-module-es5.js","sourcesContent":["module.exports = \"<ion-header>\\r\\n  <ion-toolbar mode=\\\"ios\\\">\\r\\n    <ion-menu-button slot=\\\"start\\\" class=\\\"menu-btn\\\">\\r\\n      <ion-icon slot=\\\"icon-only\\\" name=\\\"menu\\\"></ion-icon>\\r\\n    </ion-menu-button>\\r\\n    <div class=\\\"header-logo\\\" slot=\\\"start\\\"><img src=\\\"../../../assets/img/shop-logo.png\\\"></div>\\r\\n    <ion-title text-center>Vendor Registration</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <div class=\\\"main-container fixed-height\\\">\\r\\n    <ion-grid>\\r\\n      <ion-row>\\r\\n        <ion-col size=\\\"12\\\">\\r\\n          <div class=\\\"input-wrap\\\">\\r\\n            <div class=\\\"flex-label\\\">\\r\\n              <ion-label>Auto Approve Vendors</ion-label>\\r\\n              <ion-toggle [(ngModel)]=\\\"registrationFields.autoApprove\\\"></ion-toggle>\\r\\n            </div>\\r\\n          </div>\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"12\\\">\\r\\n          <div class=\\\"input-wrap\\\">\\r\\n            <ion-label>Form Title</ion-label>\\r\\n            <ion-input class=\\\"form-input\\\" [(ngModel)]=\\\"registrationFields.title\\\"></ion-input>\\r\\n          </div>\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"12\\\">\\r\\n          <div class=\\\"input-wrap\\\">\\r\\n            <ion-label>Form Description</ion-label>\\r\\n            <ion-textarea rows=\\\"4\\\" type=\\\"text\\\" class=\\\"form-input\\\" [(ngModel)]=\\\"registrationFields.description\\\">\\r\\n            </ion-textarea>\\r\\n          </div>\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"12\\\">\\r\\n          <div style=\\\"display: flex;justify-content: center\\\">\\r\\n            <ion-button (click)=\\\"saveSettings()\\\" [disabled]=\\\"disableSave()\\\" shape=\\\"round\\\" class=\\\"btn-1 i-start\\\" color=\\\"success\\\">\\r\\n              Save Form Settings\\r\\n            </ion-button>\\r\\n          </div>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n      <ion-row *ngIf=\\\"vendorRequests.length\\\">\\r\\n        <ion-col>\\r\\n          <h4>Requests</h4>\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"12\\\">\\r\\n          <div class=\\\"m-t-10\\\">\\r\\n            <ion-grid class=\\\"ion-no-padding data-table ion-text-center\\\">\\r\\n              <ion-row class=\\\"ion-text-capitalize\\\">\\r\\n                <ion-col>Vendor Name</ion-col>\\r\\n                <ion-col>Requests</ion-col>\\r\\n                <ion-col>Status</ion-col>\\r\\n              </ion-row>\\r\\n              <ion-row *ngFor=\\\"let vendor of vendorRequests; let i=index;\\\">\\r\\n                <ion-col>\\r\\n                  {{vendor.name}}\\r\\n                </ion-col>\\r\\n                <ion-col>\\r\\n                  <ion-button (click)=\\\"viewRequest(i)\\\" fill=\\\"outline\\\" shape=\\\"round\\\" size=\\\"small\\\">\\r\\n                    View Request\\r\\n                  </ion-button>\\r\\n                </ion-col>\\r\\n                <ion-col>\\r\\n                  <ng-container *ngIf=\\\"vendor.approved\\\"><b class=\\\"green\\\">Approved</b></ng-container>\\r\\n                  <ng-container *ngIf=\\\"!vendor.approved\\\">\\r\\n                    <ion-button (click)=\\\"approve(vendor.id)\\\" fill=\\\"outline\\\" shape=\\\"round\\\" size=\\\"small\\\">\\r\\n                      Approve\\r\\n                    </ion-button>\\r\\n                  </ng-container>\\r\\n                </ion-col>\\r\\n              </ion-row>\\r\\n            </ion-grid>\\r\\n          </div>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n  </div>\\r\\n</ion-content>\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { VendorRegistrationPage } from './vendor-registration.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: VendorRegistrationPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [VendorRegistrationPage]\r\n})\r\nexport class VendorRegistrationPageModule {}\r\n","module.exports = \".green {\\n  color: var(--ion-color-success);\\n}\\n\\n.data-table ion-col {\\n  border: 1px solid gray;\\n  padding-top: 10px;\\n  padding-bottom: 10px;\\n}\\n\\n.data-table ion-row:first-child {\\n  background: lightgray;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmVuZG9yLXJlZ2lzdHJhdGlvbi9DOlxcQldJLUFETUlOU1xcU2hlaW4tQWRtaW4tQ29kZS9zcmNcXGFwcFxcdmVuZG9yLXJlZ2lzdHJhdGlvblxcdmVuZG9yLXJlZ2lzdHJhdGlvbi5wYWdlLnNjc3MiLCJzcmMvYXBwL3ZlbmRvci1yZWdpc3RyYXRpb24vdmVuZG9yLXJlZ2lzdHJhdGlvbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSwrQkFBQTtBQ0NKOztBREVJO0VBQ0Esc0JBQUE7RUFDQSxpQkFBQTtFQUNBLG9CQUFBO0FDQ0o7O0FERUU7RUFDRSxxQkFBQTtBQ0FKIiwiZmlsZSI6InNyYy9hcHAvdmVuZG9yLXJlZ2lzdHJhdGlvbi92ZW5kb3ItcmVnaXN0cmF0aW9uLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5ncmVlbntcclxuICAgIGNvbG9yOiB2YXIoLS1pb24tY29sb3Itc3VjY2Vzcyk7XHJcbn1cclxuLmRhdGEtdGFibGV7ICBcclxuICAgIGlvbi1jb2x7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCBncmF5O1xyXG4gICAgcGFkZGluZy10b3A6IDEwcHg7XHJcbiAgICBwYWRkaW5nLWJvdHRvbTogMTBweFxyXG4gIH1cclxuICBcclxuICBpb24tcm93OmZpcnN0LWNoaWxke1xyXG4gICAgYmFja2dyb3VuZDogbGlnaHRncmF5XHJcbiAgfVxyXG59IiwiLmdyZWVuIHtcbiAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1zdWNjZXNzKTtcbn1cblxuLmRhdGEtdGFibGUgaW9uLWNvbCB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGdyYXk7XG4gIHBhZGRpbmctdG9wOiAxMHB4O1xuICBwYWRkaW5nLWJvdHRvbTogMTBweDtcbn1cbi5kYXRhLXRhYmxlIGlvbi1yb3c6Zmlyc3QtY2hpbGQge1xuICBiYWNrZ3JvdW5kOiBsaWdodGdyYXk7XG59Il19 */\"","import { Component, OnInit } from '@angular/core';\r\nimport { Events, ModalController } from '@ionic/angular';\r\nimport { SharedService } from 'src/app/services/shared/shared.service';\r\nimport { ConfigService } from '../services/config/config.service';\r\nimport { VendorService } from '../services/vendor/vendor.service';\r\nimport { VendorRequestModalPage } from './vendor-request-modal/vendor-request-modal.page';\r\n\r\n@Component({\r\n  selector: 'app-vendor-registration',\r\n  templateUrl: './vendor-registration.page.html',\r\n  styleUrls: ['./vendor-registration.page.scss'],\r\n})\r\nexport class VendorRegistrationPage implements OnInit {\r\n  registrationFields = {\r\n    autoApprove: false,\r\n    title: '',\r\n    description: ''\r\n  };\r\n\r\n  vendorRequests = [];\r\n  approvedRequestId;\r\n  vendorsLimit;\r\n  constructor(private events: Events,\r\n    private sharedService: SharedService,\r\n    private modalController: ModalController,\r\n    private configService: ConfigService,\r\n    private vendorService: VendorService) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  async ionViewWillEnter() {\r\n    this.vendorsLimit = this.configService.environment.vendorsLimit;\r\n    this.initializeSubscriptions();\r\n  }\r\n  ionViewWillLeave() {\r\n    this.removeSubscriptions();\r\n  }\r\n  initializeSubscriptions() {\r\n\r\n    this.events.subscribe('vendor:setMultiVendorDetailsSuccess', () => {\r\n      this.sharedService.loading.dismiss();\r\n      this.sharedService.presentAlert('Settings saved successfully');\r\n    });\r\n\r\n    this.events.subscribe('vendor:publishActiveStatus', (doc) => {\r\n      if (doc.autoApprove && doc.title && doc.description) {\r\n        this.registrationFields = doc;\r\n      }\r\n      console.log('registrationFields:', this.registrationFields);\r\n    });\r\n\r\n    this.events.subscribe('vendor:getVendorRequestsSuccess', (docs) => {\r\n      this.vendorRequests = docs;\r\n    });\r\n\r\n    this.events.subscribe('vendor:updateVendorRequestSuccess', () => {\r\n      const index = this.vendorRequests.findIndex(request => request.id === this.approvedRequestId);\r\n      this.vendorRequests[index].approved = true;\r\n      this.sharedService.presentAlert('Vendor Successfully Approved');\r\n    });\r\n\r\n    this.events.publish('vendor:getActiveStatus');\r\n    this.events.publish('vendor:getVendorRequests');\r\n\r\n  }\r\n\r\n  removeSubscriptions() {\r\n    this.events.unsubscribe('vendor:setMultiVendorDetailsSuccess');\r\n    this.events.unsubscribe('vendor:getVendorRequestsSuccess');\r\n    this.events.unsubscribe('vendor:publishActiveStatus');\r\n    this.events.unsubscribe('vendor:updateVendorRequestSuccess');\r\n  }\r\n\r\n  disableSave() {\r\n    if (this.registrationFields.title === '' || this.registrationFields.description === '') {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async saveSettings() {\r\n    await this.sharedService.presentLoading();\r\n    this.events.publish('vendor:setMultiVendorDetails', this.registrationFields);\r\n  }\r\n\r\n  async viewRequest(index){\r\n    const modal = await this.modalController.create({\r\n    component: VendorRequestModalPage,\r\n    cssClass:'custom-modal',\r\n    showBackdrop: true,\r\n    backdropDismiss: false,\r\n    componentProps: { vendorDetails: this.vendorRequests[index] }\r\n    });\r\n    modal.onDidDismiss()\r\n    .then((res) => {\r\n      console.log('data from modal', res);\r\n      if(res && res.data) {\r\n        if (res.data.approved) {\r\n          this.approve(this.vendorRequests[index].id);\r\n        }\r\n      }\r\n  });\r\n  \r\n    await modal.present();\r\n  }\r\n\r\n  async approve(requestId){\r\n    let multiVendor:any = await this.vendorService.getActiveStatus('service');\r\n    if (multiVendor.count && multiVendor.count < this.vendorsLimit) {\r\n      this.approvedRequestId = requestId;\r\n      this.events.publish('vendor:updateVendorRequest', requestId, {approved: true});\r\n    } else{\r\n      this.sharedService.presentAlert('Vendor Limit Reached');\r\n    }\r\n  }\r\n\r\n}\r\n"],"sourceRoot":""}